import{r as x,j as e}from"./jsx-runtime-IdAWuXfe.js";import{B as t}from"./react-toastify.esm-CVN34uGn.js";import{a as p}from"./js.cookie-Cz0CWeBA.js";import{i as g}from"./axios-Bl6FJLpW.js";import{u,F as b,L as m}from"./components-CJTaBzP6.js";import{j as c,r as f}from"./responses-BqwfpmZg.js";import"./axios-BimPEqV4.js";import"./index-ugiZISQl.js";import"./router-CdQiufPQ.js";function S(){return[{title:"Login with Katayani Organics"}]}const P=async({request:s})=>{var i;const o=await s.formData(),a=String(o.get("username")),n=String(o.get("password")),l={};if(a.includes("@")||(l.username="Invalid username (email)",t.error("Invalid email!")),n.length<8&&(l.password="Password should be at least 8 characters",t.error("Incorrect Password!")),Object.keys(l).length>0)return c({errors:l});try{const r=await g.post("/login",new URLSearchParams({grant_type:"password",username:a,password:n,scope:"",client_id:"",client_secret:""}),{"Content-Type":"application/x-wwww-form-urlencoded"});if(r.status===200){const d=(i=r.data)==null?void 0:i.access_token;return p.set("token",d,{expires:7}),t.success("Login Successful!"),console.log(r==null?void 0:r.data),f("/")}else return t.error("Login failed!"),c({errors:{general:"Login failed!"}})}catch(r){if(r.response){console.log(r.response),console.error("Login Error:",r.response.data);const d=r.response.data.message||"Something went wrong";r.response.status===422?t.error("Validation Error: "+d):t.error("Error during login: "+d)}else console.error("Request Error:",r),t.error("Network error or server is down");return c({errors:{general:"Login error, please try again."}})}};function F(){var i,r;const s=u(),o=(i=s==null?void 0:s.errors)==null?void 0:i.username,a=(r=s==null?void 0:s.errors)==null?void 0:r.password,[n,l]=x.useState(!1);return e.jsxs("div",{className:"flex items-center justify-center min-h-screen bg-gray-50 relative p-5 md:p-0",children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-200 via-yellow-200 to-brown-200 absolute inset-0 opacity-50"}),e.jsx("div",{className:"hidden md:block absolute top-10 left-10 w-[300px] h-[300px] bg-green-400 rounded-full blur-xl opacity-20"}),e.jsx("div",{className:"hidden md:block absolute top-40 right-20 w-[200px] h-[200px] bg-yellow-500 rounded-full blur-xl opacity-20"}),e.jsx("div",{className:"hidden md:block absolute bottom-20 left-40 w-[250px] h-[250px] bg-brown-500 rounded-full blur-xl opacity-20"}),e.jsx("div",{className:"hidden md:block absolute bottom-10 right-10 w-[150px] h-[150px] bg-green-600 rounded-full blur-xl opacity-20"})]}),e.jsxs("div",{className:"relative w-full bg-white text-gray-700 p-6 rounded-lg md:rounded-3xl shadow-lg max-w-sm md:max-w-md lg:max-w-lg md:p-8 lg:p-10",children:[e.jsxs("h1",{className:"text-2xl font-bold text-center mb-6 md:text-3xl lg:text-4xl",children:[e.jsx("span",{className:"text-gray-700",children:"Login with"})," ",e.jsx("span",{className:"text-green-600",children:"Katyayani"})]}),e.jsxs(b,{method:"post",className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{htmlFor:"email",className:"block text-left font-semibold mb-1 text-gray-600",children:"Email"}),e.jsx("input",{type:"text",id:"email",name:"username",className:`w-full bg-gray-50 border ${o?"border-red-500 focus:border-red-600":"border-green-400 focus:border-green-600"} py-3 px-4 text-base rounded-md focus:outline-none transition-all`,placeholder:"Email"}),o&&e.jsx("p",{className:"text-sm text-red-500 font-semibold",children:o})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{htmlFor:"password",className:"block text-left font-semibold mb-1 text-gray-600",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",name:"password",type:n?"text":"password",placeholder:"Password",className:`w-full bg-gray-50 border ${a?"border-red-500 focus:border-red-600":"border-green-400 focus:border-green-600"} py-3 px-4 text-base rounded-md focus:outline-none transition-all`}),e.jsx("i",{className:`absolute right-3 top-1/2 transform -translate-y-1/2 cursor-pointer text-gray-600 ${n?"ri-eye-fill":"ri-eye-off-fill"}`,onClick:()=>l(!n)})]}),a&&e.jsx("p",{className:"text-sm text-red-500 font-semibold",children:a}),e.jsx(m,{to:"/resetpassword",children:e.jsx("p",{className:"text-right mt-1 text-sm text-green-600 hover:text-green-700 transition",children:"Forgot Password?"})})]}),e.jsxs("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-md font-semibold transition-transform transform hover:scale-105",children:["Sign In ",e.jsx("i",{className:"ri-lock-line"})]}),e.jsxs("div",{className:"flex justify-center mt-6 text-sm text-gray-600",children:[e.jsx("span",{children:"Don't have an account?"}),e.jsx(m,{to:"/register",className:"text-green-600 font-semibold hover:text-green-700 transition ml-1",children:"Sign Up"})]})]})]})]})}export{P as clientAction,F as default,S as meta};
